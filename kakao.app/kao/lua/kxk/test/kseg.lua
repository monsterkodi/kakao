kxk = require "kxk/kxk"

test("kseg", function()
    test("pop", function()
        local s = kseg("../")
        s:pop()
        test.cmp(s:str(), "..")
        
        s = kseg("â—‚â–¸â—‹â—")
        s:pop()
        test.cmp(s:str(), "â—‚â–¸â—‹")
        s:pop()
        test.cmp(s:str(), "â—‚â–¸")
    end)
    
    test("push", function()
        local s = kseg()
        test.cmp(#s, 0)
        s:push("â—")
        test.cmp(s:str(), "â—")
        test.cmp(#s, 1)
        s:push("â–ª")
        test.cmp(s:str(), "â—â–ª")
        test.cmp(#s, 2)
        s:push(" ")
        test.cmp(s:str(), "â—â–ª ")
        test.cmp(#s, 3)
    end)
    
    test("rpad", function()
        local s = kseg("â–´")
        s:rpad(2)
        test.cmp(s:str(), "â–´ ")
        s:rpad(4)
        test.cmp(s:str(), "â–´   ")
        s:rpad(2)
        test.cmp(s:str(), "â–´   ")
    end)
    
    test("trim", function()
        local s = kseg(" â–´  ")
        s:trim()
        test.cmp(s:str(), "â–´")
        
        s = kseg(" â–´  ")
        s:rtrim()
        test.cmp(s:str(), " â–´")
        
        s = kseg(" â–´  ")
        s:ltrim()
        test.cmp(s:str(), "â–´  ")
        
        s = kseg("\n\n â–´  \n  \n")
        s:trim()
        test.cmp(s:str(), "â–´")
    end)
    
    test("emojii", function()
        local s = kseg("ğŸ§‘")
        test.cmp(#s, 1)
        
        s = kseg("ğŸ§‘â€ğŸŒ¾")
        test.cmp(#s, 3)
        test.cmp(s[#s], "ğŸŒ¾")
        s:pop()
        s:pop()
        test.cmp(#s, 1)
        test.cmp(s:str(), "ğŸ§‘")
    end)
    
    test("is", function()
        local a = kseg("")
        test.cmp(a:is(kseg), true)
        test.cmp(a:is(array), true)
        test.cmp(a:is(table), false)
        test.cmp(a:is(false), false)
        test.cmp(a:is(true), false)
        test.cmp(a:is(nil), false)
    end)
    end)